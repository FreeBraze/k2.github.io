<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂçïËØçË∂£Âë≥Ê∂àÊ∂à‰πê - Unit 2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }

        body {
            background: linear-gradient(135deg, #e6f7ff, #c2e9fb);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        .wave {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" fill="%2346a0f5"/><path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".5" fill="%2346a0f5"/><path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="%2346a0f5"/></svg>');
            background-size: cover;
            z-index: 1;
        }

        .books {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 2;
        }

        .book {
            width: 40px;
            height: 50px;
            background: #8B4513;
            border-radius: 3px;
            position: relative;
        }

        .book:nth-child(2) {
            background: #A0522D;
            height: 55px;
        }

        .book:nth-child(3) {
            background: #CD853F;
            height: 45px;
        }

        .book::after {
            content: "";
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        .flower-branch {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 100px;
            height: 120px;
            z-index: 2;
        }

        .branch {
            position: absolute;
            width: 5px;
            height: 100px;
            background: #8B7355;
            top: 0;
            right: 50px;
            border-radius: 3px;
            transform: rotate(-10deg);
        }

        .flower {
            position: absolute;
            width: 25px;
            height: 25px;
            background: #FFB6C1;
            border-radius: 50%;
            top: 15px;
            right: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .flower::before {
            content: "";
            position: absolute;
            width: 10px;
            height: 10px;
            background: #FFD700;
            border-radius: 50%;
        }

        .petal {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #FFB6C1;
            border-radius: 50%;
        }

        .petal:nth-child(1) {
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
        }

        .petal:nth-child(2) {
            top: 50%;
            right: -5px;
            transform: translateY(-50%);
        }

        .petal:nth-child(3) {
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
        }

        .petal:nth-child(4) {
            top: 50%;
            left: -5px;
            transform: translateY(-50%);
        }

        .leaf {
            position: absolute;
            width: 15px;
            height: 10px;
            background: #90EE90;
            border-radius: 50% 0 50% 0;
            top: 40px;
            right: 45px;
            transform: rotate(45deg);
        }

        .leaf:nth-child(2) {
            top: 60px;
            right: 40px;
            transform: rotate(-30deg);
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin: 0 auto;
            z-index: 3;
            position: relative;
        }

        .page {
            display: none;
            width: 100%;
        }

        .page.active {
            display: block;
        }

        .unit-selection-page h1 {
            text-align: center;
            color: #6a5acd;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }

        .units-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        .unit-item {
            display: flex;
            width: 100%;
            max-width: 350px;
            margin-bottom: 20px;
        }

        .unit-circle {
            width: 80px;
            height: 80px;
            background: #FFD700;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
            margin-right: 20px;
            flex-shrink: 0;
        }

        .unit-circle span {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }

        .unit-card {
            flex-grow: 1;
            background: #f9f9f9;
            border-radius: 15px;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .unit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-color: #6a5acd;
        }

        .unit-card h3 {
            color: #333;
            margin-bottom: 5px;
            font-size: 1.2rem;
        }

        .unit-card p {
            color: #666;
            font-size: 0.9rem;
        }

        .unit-detail-page {
            text-align: center;
        }

        .btn-back {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #6a5acd;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
        }

        .btn-back:hover {
            background: #5a4abd;
            transform: scale(1.1);
        }

        .unit-detail-page .unit-circle {
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
        }

        .unit-detail-page .unit-circle span {
            font-size: 2.5rem;
        }

        .dropdown-area {
            margin: 30px 0;
            position: relative;
        }

        .dropdown {
            width: 100%;
            padding: 15px 20px;
            background: white;
            border: 2px solid #E0E0E0;
            border-radius: 10px;
            font-size: 1.2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .dropdown:hover {
            border-color: #6a5acd;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-challenge {
            background: #D2B48C;
            color: white;
        }

        .btn-challenge:hover {
            background: #C19A6B;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(194, 154, 107, 0.3);
        }

        .btn-pk {
            background: #FFD700;
            color: #333;
        }

        .btn-pk:hover {
            background: #FFC400;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 196, 0, 0.3);
        }

        .game-page h1 {
            text-align: center;
            color: #6a5acd;
            margin-bottom: 20px;
            font-size: 2.5rem;
        }

        .game-controls {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 20px;
            gap: 15px;
            background: #f8f9ff;
            padding: 15px;
            border-radius: 15px;
        }

        .control-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        select,
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        select {
            background-color: #f0f8ff;
            border: 2px solid #b0e0e6;
            min-width: 120px;
        }

        button {
            background: linear-gradient(to right, #6a5acd, #9370db);
            color: white;
            font-weight: bold;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #555;
            background: #f0f8ff;
            padding: 10px 20px;
            border-radius: 10px;
        }

        .timer {
            font-size: 1.8rem;
            text-align: center;
            margin: 20px 0;
            color: #ff6347;
            font-weight: bold;
            background: #fff9f0;
            padding: 10px;
            border-radius: 10px;
        }

        .game-board {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .player-section {
            flex: 1;
            background: #f9f9f9;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            min-height: 400px;
        }

        .player-header {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
            color: #6a5acd;
            padding-bottom: 10px;
            border-bottom: 2px solid #e6e6fa;
        }

        .cards-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            min-height: 300px;
            align-content: flex-start;
        }

        .card {
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            user-select: none;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-word;
        }

        .english-card {
            background: linear-gradient(135deg, #ffb6c1, #ff69b4);
            color: #8b0000;
        }

        .chinese-card {
            background: linear-gradient(135deg, #87ceeb, #1e90ff);
            color: #000080;
        }

        .card.selected {
            transform: scale(1.1);
            box-shadow: 0 0 15px 5px rgba(255, 215, 0, 0.7);
            z-index: 10;
        }

        .card.matched {
            visibility: hidden;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s;
        }

        .card.wrong {
            animation: shake 0.5s;
            background: linear-gradient(135deg, #ff9999, #ff3333);
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            20%,
            60% {
                transform: translateX(-5px);
            }

            40%,
            80% {
                transform: translateX(5px);
            }
        }

        .current-player-indicator {
            background: #ffeb3b;
            color: #333;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
            display: inline-block;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal h2 {
            color: #6a5acd;
            margin-bottom: 15px;
        }

        .modal p {
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .winner-section {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            gap: 20px;
        }

        .winner-trophy {
            font-size: 3rem;
            color: gold;
        }

        .pause-overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 5;
            justify-content: center;
            align-items: center;
            border-radius: 20px;
        }

        .pause-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .pause-content h2 {
            color: #6a5acd;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 20px;
            }

            .unit-selection-page h1 {
                font-size: 2rem;
            }

            .unit-item {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .unit-circle {
                margin-right: 0;
                margin-bottom: 15px;
            }

            .unit-detail-page .unit-circle {
                width: 100px;
                height: 100px;
            }

            .unit-detail-page .unit-circle span {
                font-size: 2rem;
            }

            .dropdown {
                font-size: 1rem;
            }

            .btn {
                font-size: 1rem;
                padding: 12px 25px;
            }

            .game-board {
                flex-direction: column;
            }

            .game-controls {
                flex-direction: column;
                align-items: center;
            }

            h1 {
                font-size: 1.8rem;
            }

            .card {
                font-size: 1.2rem;
                min-width: 100px;
                padding: 12px 15px;
            }

            .control-group {
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div class="wave"></div>

    <div class="books">
        <div class="book"></div>
        <div class="book"></div>
        <div class="book"></div>
    </div>

    <div class="flower-branch">
        <div class="branch"></div>
        <div class="flower">
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
        </div>
        <div class="leaf"></div>
        <div class="leaf"></div>
    </div>

    <div class="container">
        <div class="page unit-selection-page active" id="unitSelectionPage">
            <div class="units-container">
                <div class="unit-item">
                    <div class="unit-circle">
                        <span>Unit 2</span>
                    </div>
                    <div class="unit-card" data-unit="1">
                        <h3>Life stories</h3>
                        <p>‰∫∫ÁîüÊïÖ‰∫ã</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="page unit-detail-page" id="unitDetailPage">
            <button class="btn-back" id="backButton">‚Üê</button>

            <div class="unit-circle">
                <span id="currentUnit">Unit 2</span>
            </div>

            <div class="dropdown-area">
                <div class="dropdown" id="unitDropdown">The digital age: Are we ready?</div>
            </div>

            <div class="game-controls">
                <div class="control-group">
                    <label for="difficulty">ÈöæÂ∫¶ÈÄâÊã©Ôºö</label>
                    <select id="difficulty">
                        <option value="5">ÂÆπÊòìÔºà5ËØçÔºâ</option>
                        <option value="10" selected>ÊôÆÈÄöÔºà10ËØçÔºâ</option>
                        <option value="15">Âõ∞ÈöæÔºà15ËØçÔºâ</option>
                    </select>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-challenge" id="challengeButton">ÂºÄÂßãÈóØÂÖ≥</button>
                <button class="btn btn-pk" id="pkButton">Âèå‰∫∫PK</button>
            </div>
        </div>

        <div class="page game-page" id="gamePage">
            <button class="btn-back" id="backToDetailButton">‚Üê</button>

            <h1>ÂçïËØçË∂£Âë≥Ê∂àÊ∂à‰πê</h1>

            <div class="game-controls">
                <div class="control-group">
                    <div>ÂΩìÂâçÂçïÂÖÉ: <span id="currentUnitDisplay">Unit 1</span></div>
                    <div>Ê∏∏ÊàèÊ®°Âºè: <span id="currentModeDisplay">Âçï‰∫∫Ê®°Âºè</span></div>
                    <div>ÈöæÂ∫¶: <span id="currentDifficultyDisplay">ÊôÆÈÄöÔºà10ËØçÔºâ</span></div>
                </div>

                <div class="control-group">
                    <button id="startBtn">ÂºÄÂßãÊ∏∏Êàè</button>
                    <button id="pauseBtn">ÊöÇÂÅú</button>
                    <button id="restartBtn">ÈáçÊñ∞ÂºÄÂßã</button>
                </div>
            </div>

            <div class="game-info">
                <div>Áé©ÂÆ∂1ÂæóÂàÜ: <span id="player1Score">0</span></div>
                <div>Áé©ÂÆ∂2ÂæóÂàÜ: <span id="player2Score">0</span></div>
            </div>

            <div class="timer">
                Áî®Êó∂: <span id="timerDisplay">00:00</span>
            </div>

            <div class="pause-overlay" id="pauseOverlay">
                <div class="pause-content">
                    <h2>Ê∏∏ÊàèÂ∑≤ÊöÇÂÅú</h2>
                    <p>ÁÇπÂáª"ÁªßÁª≠"ÊåâÈíÆÊÅ¢Â§çÊ∏∏Êàè</p>
                    <button id="resumeBtn">ÁªßÁª≠</button>
                </div>
            </div>

            <div class="game-board">
                <div class="player-section">
                    <div class="player-header">Áé©ÂÆ∂1</div>
                    <div id="player1Indicator" class="current-player-indicator" style="display: none;">ÂΩìÂâçÁé©ÂÆ∂</div>
                    <div class="cards-container" id="player1Cards"></div>
                </div>

                <div class="player-section">
                    <div class="player-header">Áé©ÂÆ∂2</div>
                    <div id="player2Indicator" class="current-player-indicator" style="display: none;">ÂΩìÂâçÁé©ÂÆ∂</div>
                    <div class="cards-container" id="player2Cards"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="successModal">
        <div class="modal-content">
            <h2>Ê∏∏ÊàèÂÆåÊàêÔºÅ</h2>
            <div class="winner-section">
                <div class="winner-trophy">üèÜ</div>
                <div>
                    <p id="winnerText">Áé©ÂÆ∂1Ëé∑ËÉúÔºÅ</p>
                    <p>Áî®Êó∂: <span id="completionTime">00:00</span></p>
                </div>
                <div class="winner-trophy">üèÜ</div>
            </div>
            <button id="closeModal">ËøîÂõû‰∏ªÈ°µÈù¢</button>
        </div>
    </div>

    <script>
        const wordData = {
            1: [
                { english: "camel", chinese: "n. [C] È™ÜÈ©º" },
                { english: "yore", chinese: "n. [U]ÔºàËØóÔºâÂæÄÊòîÔºåÊòîÊó∂" },
                { english: "pearl", chinese: "n. [C, U] ÁèçÁè†ÔºõÁèçÂìÅ" },
                { english: "journal", chinese: "n. [C] Êó•ÂøóÔºõÊó•ËÆ∞ÔºõÊúüÂàä" },
                { english: "exotic", chinese: "a. Áî±Â§ñÂõΩÂºïËøõÁöÑÔºõÂÖ∑ÊúâÂºÇÂõΩÊÉÖË∞ÉÁöÑ" },
                { english: "naval", chinese: "a.ÔºàÂ∞§ÊåáÊóßÊó∂ÔºâÊµ∑ÂÜõÁöÑÔºõÂÜõËà∞ÁöÑ" },
                { english: "treaty", chinese: "n. [C]ÔºàÂõΩÂÆ∂‰πãÈó¥ÁöÑÔºâÊù°Á∫¶ÔºõÂçèËÆÆ" },
                { english: "past", chinese: "n. [sing.] ËøáÂéªÔºåÊòîÊó•" },
                { english: "pirate", chinese: "n. [C] Êµ∑ÁõóÔºõv. Êä¢Âä´ÔºàÊµ∑‰∏äËàπÂè™Ôºâ" },
                { english: "diplomatic", chinese: "a. Â§ñ‰∫§ÁöÑÔºõ‰ªé‰∫ãÂ§ñ‰∫§ÁöÑ" },
                { english: "ambassador", chinese: "n. [C] Â§ß‰Ωø" },
                { english: "realm", chinese: "n. [C] ÁéãÂõΩÔºõÔºàÁü•ËØÜ„ÄÅÊ¥ªÂä®„ÄÅÊÄùÊÉ≥ÁöÑÔºâÈ¢ÜÂüüÔºåËåÉÂõ¥" },
                { english: "maintenance", chinese: "n. [U] Áª¥Êä§Ôºõ‰øùÂÖªÔºõÁª¥‰øÆ" },
                { english: "appoint", chinese: "v. ‰ªªÂëΩÔºõÊåáÂÆöÔºàÊó∂Èó¥ÊàñÂú∞ÁÇπÔºâ" },
                { english: "liquor", chinese: "n. [U] ÁÉàÊÄßÈÖí" }
            ]
        };

        const unitData = {
            1: {
                title: "Unit 2",
                topic: "Life stories",
                description: "‰∫∫ÁîüÊïÖ‰∫ã"
            }
        };

        let gameActive = false;
        let gameStarted = false;
        let gamePaused = false;
        let startTime;
        let pauseStartTime = 0;
        let totalPauseTime = 0;
        let timerInterval;
        let currentPlayer = 1;
        let selectedCard = null;
        let player1Score = 0;
        let player2Score = 0;
        let player1Matched = 0;
        let player2Matched = 0;
        let totalPairs = 0;
        let gameMode = "single";
        let currentUnit = 1;
        let currentDifficulty = 10;

        const unitSelectionPage = document.getElementById('unitSelectionPage');
        const unitDetailPage = document.getElementById('unitDetailPage');
        const gamePage = document.getElementById('gamePage');
        const unitCards = document.querySelectorAll('.unit-card');
        const backButton = document.getElementById('backButton');
        const backToDetailButton = document.getElementById('backToDetailButton');
        const currentUnitElement = document.getElementById('currentUnit');
        const unitDropdown = document.getElementById('unitDropdown');
        const challengeButton = document.getElementById('challengeButton');
        const pkButton = document.getElementById('pkButton');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resumeBtn = document.getElementById('resumeBtn');
        const restartBtn = document.getElementById('restartBtn');
        const difficultySelect = document.getElementById('difficulty');
        const timerDisplay = document.getElementById('timerDisplay');
        const player1ScoreDisplay = document.getElementById('player1Score');
        const player2ScoreDisplay = document.getElementById('player2Score');
        const player1CardsContainer = document.getElementById('player1Cards');
        const player2CardsContainer = document.getElementById('player2Cards');
        const player1Indicator = document.getElementById('player1Indicator');
        const player2Indicator = document.getElementById('player2Indicator');
        const successModal = document.getElementById('successModal');
        const winnerText = document.getElementById('winnerText');
        const completionTime = document.getElementById('completionTime');
        const closeModalBtn = document.getElementById('closeModal');
        const pauseOverlay = document.getElementById('pauseOverlay');
        const currentUnitDisplay = document.getElementById('currentUnitDisplay');
        const currentModeDisplay = document.getElementById('currentModeDisplay');
        const currentDifficultyDisplay = document.getElementById('currentDifficultyDisplay');

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        unitCards.forEach(card => {
            card.addEventListener('click', function () {
                const unitId = parseInt(this.getAttribute('data-unit'));
                currentUnit = unitId;
                updateUnitDetailPage(unitId);
                showPage('unitDetailPage');
            });
        });

        backButton.addEventListener('click', function () {
            showPage('unitSelectionPage');
        });

        backToDetailButton.addEventListener('click', function () {
            showPage('unitDetailPage');
        });

        function updateUnitDetailPage(unitId) {
            const unit = unitData[unitId];
            currentUnitElement.textContent = unit.title;
            unitDropdown.textContent = unit.topic;
        }

        challengeButton.addEventListener('click', function () {
            gameMode = "single";
            currentDifficulty = parseInt(difficultySelect.value);
            showPage('gamePage');
            setupGame();
        });

        pkButton.addEventListener('click', function () {
            gameMode = "double";
            currentDifficulty = parseInt(difficultySelect.value);
            showPage('gamePage');
            setupGame();
        });

        function playSound(type) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            let oscillator = audioContext.createOscillator();
            let gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            switch (type) {
                case 'match':
                    oscillator.frequency.setValueAtTime(880, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    break;
                case 'error':
                    oscillator.frequency.setValueAtTime(220, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    break;
                case 'win':
                    const frequencies = [523.25, 659.25, 783.99, 1046.50];
                    const times = [0, 0.2, 0.4, 0.6];
                    frequencies.forEach((freq, i) => {
                        setTimeout(() => {
                            const osc = audioContext.createOscillator();
                            const gain = audioContext.createGain();
                            osc.connect(gain);
                            gain.connect(audioContext.destination);
                            osc.frequency.setValueAtTime(freq, audioContext.currentTime);
                            gain.gain.setValueAtTime(0.3, audioContext.currentTime);
                            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                            osc.start(audioContext.currentTime);
                            osc.stop(audioContext.currentTime + 0.3);
                        }, times[i] * 1000);
                    });
                    return;
                case 'select':
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    break;
                case 'pause':
                    oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    break;
            }

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function setupGame() {
            currentUnitDisplay.textContent = unitData[currentUnit].title;
            currentModeDisplay.textContent = gameMode === "single" ? "Âçï‰∫∫Ê®°Âºè" : "Âèå‰∫∫ÂØπÊàò";
            currentDifficultyDisplay.textContent = getDifficultyText(currentDifficulty);

            gameActive = false;
            gameStarted = false;
            gamePaused = false;
            player1Score = 0;
            player2Score = 0;
            player1Matched = 0;
            player2Matched = 0;
            currentPlayer = 1;
            selectedCard = null;
            totalPauseTime = 0;

            player1ScoreDisplay.textContent = '0';
            player2ScoreDisplay.textContent = '0';
            timerDisplay.textContent = '00:00';

            updatePlayerIndicator();

            player1CardsContainer.innerHTML = '';
            player2CardsContainer.innerHTML = '';

            const words = [...wordData[currentUnit]];
            const selectedWords = [];
            while (selectedWords.length < currentDifficulty && words.length > 0) {
                const randomIndex = Math.floor(Math.random() * words.length);
                selectedWords.push(words[randomIndex]);
                words.splice(randomIndex, 1);
            }

            totalPairs = selectedWords.length;

            if (gameMode === "single") {
                document.querySelector('.player-section:nth-child(2)').style.display = 'none';
                createCards(selectedWords, player1CardsContainer);
            } else {
                document.querySelector('.player-section:nth-child(2)').style.display = 'block';
                createCards(selectedWords, player1CardsContainer);
                createCards(selectedWords, player2CardsContainer);
            }

            clearInterval(timerInterval);

            pauseOverlay.style.display = 'none';
            pauseBtn.textContent = 'ÊöÇÂÅú';

            startBtn.disabled = false;
            pauseBtn.disabled = true;
        }

        function getDifficultyText(difficulty) {
            switch (difficulty) {
                case 5: return "ÂÆπÊòìÔºà5ËØçÔºâ";
                case 10: return "ÊôÆÈÄöÔºà10ËØçÔºâ";
                case 15: return "Âõ∞ÈöæÔºà15ËØçÔºâ";
                default: return "ÊôÆÈÄöÔºà10ËØçÔºâ";
            }
        }

        function startGame() {
            if (gameStarted) return;

            gameActive = true;
            gameStarted = true;

            startTime = new Date();
            clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 1000);
            updateTimer();

            startBtn.disabled = true;
            pauseBtn.disabled = false;

            playSound('select');
        }

        function pauseGame() {
            if (!gameActive || gamePaused) return;

            gamePaused = true;
            pauseStartTime = new Date();

            clearInterval(timerInterval);

            pauseOverlay.style.display = 'flex';
            pauseBtn.textContent = 'Â∑≤ÊöÇÂÅú';

            playSound('pause');
        }

        function resumeGame() {
            if (!gamePaused) return;

            gamePaused = false;

            const pauseEndTime = new Date();
            totalPauseTime += (pauseEndTime - pauseStartTime);

            timerInterval = setInterval(updateTimer, 1000);

            pauseOverlay.style.display = 'none';
            pauseBtn.textContent = 'ÊöÇÂÅú';

            playSound('select');
        }

        function createCards(words, container) {
            const englishCards = [];
            const chineseCards = [];

            words.forEach(word => {
                const englishCard = document.createElement('div');
                englishCard.className = 'card english-card';
                englishCard.textContent = word.english;
                englishCard.dataset.word = word.english;
                englishCard.dataset.type = 'english';
                englishCards.push(englishCard);

                const chineseCard = document.createElement('div');
                chineseCard.className = 'card chinese-card';
                chineseCard.textContent = word.chinese;
                chineseCard.dataset.word = word.english;
                chineseCard.dataset.type = 'chinese';
                chineseCards.push(chineseCard);
            });

            const allCards = [...englishCards, ...chineseCards];
            shuffleArray(allCards);

            allCards.forEach(card => {
                container.appendChild(card);
                card.addEventListener('click', function () {
                    handleCardClick(this, container.id === 'player1Cards' ? 1 : 2);
                });
            });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function updateTimer() {
            if (!gameActive) return;

            const currentTime = new Date();
            const elapsedTime = Math.floor((currentTime - startTime - totalPauseTime) / 1000);
            const minutes = Math.floor(elapsedTime / 60).toString().padStart(2, '0');
            const seconds = (elapsedTime % 60).toString().padStart(2, '0');

            timerDisplay.textContent = `${minutes}:${seconds}`;
        }

        function updatePlayerIndicator() {
            if (gameMode === "single") {
                player1Indicator.style.display = 'none';
                player2Indicator.style.display = 'none';
            } else {
                player1Indicator.style.display = currentPlayer === 1 ? 'block' : 'none';
                player2Indicator.style.display = currentPlayer === 2 ? 'block' : 'none';
            }
        }

        function handleCardClick(card, player) {
            if (!gameActive || gamePaused) return;

            if (gameMode === "double" && player !== currentPlayer) return;

            if (!card.classList.contains('card') || card.classList.contains('matched')) return;

            if (card === selectedCard) return;

            playSound('select');

            card.classList.add('selected');

            if (!selectedCard) {
                selectedCard = { card: card, player: player };
                return;
            }

            if (selectedCard.card.dataset.word === card.dataset.word &&
                selectedCard.card.dataset.type !== card.dataset.type) {
                setTimeout(() => {
                    selectedCard.card.classList.add('matched');
                    card.classList.add('matched');
                    selectedCard = null;

                    playSound('match');

                    if (gameMode === "single") {
                        player1Score += 5;
                        player1Matched++;
                        player1ScoreDisplay.textContent = player1Score;
                    } else {
                        if (currentPlayer === 1) {
                            player1Score += 5;
                            player1Matched++;
                            player1ScoreDisplay.textContent = player1Score;
                        } else {
                            player2Score += 5;
                            player2Matched++;
                            player2ScoreDisplay.textContent = player2Score;
                        }
                    }

                    checkGameCompletion();
                }, 300);
            } else {
                setTimeout(() => {
                    selectedCard.card.classList.remove('selected');
                    card.classList.remove('selected');
                    selectedCard = null;

                    playSound('error');

                    if (gameMode === "double") {
                        currentPlayer = currentPlayer === 1 ? 2 : 1;
                        updatePlayerIndicator();
                    }
                }, 500);
            }
        }

        function checkGameCompletion() {
            if (gameMode === "single") {
                if (player1Matched === totalPairs) {
                    endGame();
                }
            } else {
                if (player1Matched === totalPairs || player2Matched === totalPairs) {
                    endGame();
                }
            }
        }

        function endGame() {
            gameActive = false;
            gameStarted = false;
            clearInterval(timerInterval);

            let winner;
            if (gameMode === "single") {
                winnerText.textContent = "ÊÅ≠Âñú‰Ω†ÂÆåÊàê‰∫ÜÊ∏∏ÊàèÔºÅ";
            } else {
                if (player1Matched === totalPairs && player2Matched === totalPairs) {
                    if (player1Score > player2Score) {
                        winner = 1;
                    } else if (player2Score > player1Score) {
                        winner = 2;
                    } else {
                        winner = 0;
                    }
                } else if (player1Matched === totalPairs) {
                    winner = 1;
                } else {
                    winner = 2;
                }

                if (winner === 0) {
                    winnerText.textContent = "Âπ≥Â±ÄÔºÅ";
                } else {
                    winnerText.textContent = `Áé©ÂÆ∂${winner}Ëé∑ËÉúÔºÅ`;
                }
            }

            completionTime.textContent = timerDisplay.textContent;
            successModal.style.display = 'flex';

            playSound('win');
        }

        function restartGame() {
            gameActive = false;
            gameStarted = false;
            clearInterval(timerInterval);
            setupGame();
        }

        function returnToMain() {
            successModal.style.display = 'none';
            gameActive = false;
            gameStarted = false;
            clearInterval(timerInterval);
            player1CardsContainer.innerHTML = '';
            player2CardsContainer.innerHTML = '';
            player1ScoreDisplay.textContent = '0';
            player2ScoreDisplay.textContent = '0';
            timerDisplay.textContent = '00:00';
            document.querySelector('.player-section:nth-child(2)').style.display = 'block';
            showPage('unitSelectionPage');
        }

        startBtn.addEventListener('click', startGame);
        pauseBtn.addEventListener('click', pauseGame);
        resumeBtn.addEventListener('click', resumeGame);
        restartBtn.addEventListener('click', restartGame);
        closeModalBtn.addEventListener('click', returnToMain);

        timerDisplay.textContent = "00:00";
        document.querySelector('.player-section:nth-child(2)').style.display = 'none';
    </script>
</body>

</html>
